# D.3 Описание промптов

Принципы проверки, роль наставника и структура обратной связи в промптах ДЗ-чекера.

---

## Структура промптов

ДЗ-чекер использует два промпта:

| Промпт | Файл | Назначение |
|--------|------|------------|
| **Системный** | `data/prompts/system.txt` | Роль, принципы, формат |
| **Шаблон проверки** | `data/prompts/check_template.txt` | Структура запроса с переменными |

---

## Системный промпт

### Роль

> Ты — опытный наставник образовательной программы по системному мышлению.

Наставник, а не судья. Цель — помочь студенту учиться, а не наказать за ошибки.

### Принципы проверки

1. **Доброжелательность**
   - Конструктивная критика
   - Поддержка студента
   - Признание сильных сторон

2. **Конкретность**
   - Указывать конкретные места в ответе
   - Не абстрактные замечания
   - Примеры из ответа студента

3. **Опора на норматив**
   - Оценивать относительно материалов курса
   - Не использовать личные знания
   - Ссылаться на источник

4. **Развивающая обратная связь**
   - Рекомендации для улучшения
   - Следующий шаг для углубления
   - Связь с другими темами

5. **Честность**
   - Если ответ слабый — сказать об этом
   - Конструктивно, не обидно
   - С путём к исправлению

### Важные правила

- **Не додумывать за студента** — оценивать то, что написано
- **Краткий, но по существу = нормально** — не требовать многословия
- **Длинный, но не по теме = проблема** — качество важнее объёма
- **Терминология из курса = плюс**
- **Собственные примеры = большой плюс**

---

## Шаблон проверки

### Структура

```markdown
## Вопрос домашнего задания
{question_text}

---

## Ответ студента
{answer_text}

---

## Норматив (материал, на который должен опираться студент)
{normative_content}

---

## Критерии оценки
{rubric_criteria}

---

## Инструкция
Проверь ответ студента по указанным критериям, опираясь на норматив.
Верни результат в формате JSON...
```

### Переменные

| Переменная | Источник | Описание |
|------------|----------|----------|
| `{question_text}` | LMS | Текст вопроса |
| `{answer_text}` | Студент | Ответ студента |
| `{normative_content}` | Репозиторий | Фрагмент руководства |
| `{rubric_criteria}` | Репозиторий | Форматированные критерии |

---

## Формат ответа LLM

### JSON-структура

```json
{
  "verdict": "accepted | needs_revision | rejected",
  "score": 0-100,
  "strengths": ["string", ...],
  "issues": [
    {
      "criterion": "criterion_id",
      "issue": "Что не так",
      "suggestion": "Как улучшить"
    }
  ],
  "next_step": "Рекомендация для дальнейшего изучения",
  "criterion_scores": {
    "criterion_id": score,
    ...
  }
}
```

### Правила verdict

| Verdict | Условие |
|---------|---------|
| `accepted` | score >= 60 и все ключевые критерии выполнены |
| `needs_revision` | score >= 40, но есть существенные недочёты |
| `rejected` | score < 40 или ответ не по теме |

---

## Структура комментария для студента

Результат форматируется в Markdown:

```markdown
**✓ Принято** (85/100)

**Сильные стороны:**
- Верно указано ключевое положение: любая модель фокусируется...
- Приведён хороший практический пример

**Замечания:**
- Не использован термин «описание системы»
  _Рекомендация: используйте терминологию из материалов_

**Следующий шаг:**
Попробуйте привести ещё один пример из другой области

---
*Проверено: Claude 3.5 Sonnet*
*По материалам: Физический мир и ментальное пространство*
```

---

## Примеры хороших и плохих комментариев

### Хорошо

> **Сильные стороны:**
> - Вы верно указали, что модель фокусируется на определённых свойствах — это ключевая идея раздела

### Плохо

> **Сильные стороны:**
> - Хороший ответ

(Слишком абстрактно, не указано что именно хорошо)

### Хорошо

> **Замечания:**
> - Вы написали "разные описания", но в курсе используется термин "описание системы". Рекомендую использовать точную терминологию.

### Плохо

> **Замечания:**
> - Неправильная терминология

(Не указано что неправильно и как исправить)

---

## Развитие промптов

### v0.1 (текущая)
- Базовые принципы
- Универсальный формат
- Одна рубрика

### v0.2 (планируется)
- A/B-тестирование формулировок
- Специализированные промпты для разных типов вопросов
- Обратная связь от наставников

---

## Связанные документы

- [D.4 Рубрики проверки](./D.4%20Рубрики%20проверки.md)
- Рабочий файл: `agents-core/homework-checker/data/prompts/system.txt`
- Рабочий файл: `agents-core/homework-checker/data/prompts/check_template.txt`

---

**Версия:** 0.1
**Дата:** 2025-12-23
