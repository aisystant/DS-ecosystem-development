# Перечень документов для первого релиза (v0.1) ДЗ-чекера

Документ составлен на основе [Общего описания Проверяльщика ДЗ](../Общее%20описание%20Проверяльщика%20ДЗ%20(ДЗ-чекер)%203.2.md).

---

## Системы и их расположение

| Система | Роль | Реализация |
|---------|------|------------|
| **ДЗ-чекер** | Движок проверки ДЗ | n8n workflow (7 нод) |
| **Репозиторий руководств** | Хранилище нормативов | MCP-сервер (v0.2) / заглушка httpbin (v0.1) |
| **LMS (Aisystant)** | Интерфейс студента | Внешняя система |
| **LLM (Claude API)** | Исполнитель проверки | Внешний сервис (claude-3-haiku-20240307) |

---

## Часть 1: Описания (content/)

Документы для согласования, чтения людьми, понимания системы.

**Расположение:** `content/.../3.2.4.3. Проверяльщик ДЗ/Спецификации v0.1/`

| № | Документ | Описание | Статус |
|---|----------|----------|--------|
| D.1 | [Спецификация API ДЗ-чекера](../Спецификации%20v0.1/D.1%20Спецификация%20API%20ДЗ-чекера.md) | Webhook endpoint, формат запроса/ответа, коды ошибок | ✅ |
| D.2 | [Интеграция с репозиторием руководств](../Спецификации%20v0.1/D.2%20Интеграция%20с%20репозиторием%20руководств.md) | Формат запроса контекста, формат ответа | ✅ |
| D.3 | [Описание промптов](../Спецификации%20v0.1/D.3%20Описание%20промптов.md) | Структура промпта, формат ответа LLM | ✅ |
| D.4 | [Рубрики проверки](../Спецификации%20v0.1/D.4%20Рубрики%20проверки.md) | Критерии оценки, веса, пороги решений | ✅ |
| D.5 | [Требования к LMS](../Спецификации%20v0.1/D.5%20Требования%20к%20LMS.md) | UI кнопки, отображение результата, обработка ошибок | ✅ |

---

## Часть 2: n8n Workflow

Workflow реализован в n8n и состоит из 7 нод.

### Ноды workflow

| № | Нода | Тип | Назначение |
|---|------|-----|------------|
| 1 | Webhook | Trigger | POST `/webhook/check` — приём запросов от LMS |
| 2 | Code (Validate) | Code | Валидация обязательных полей, 400 при ошибке |
| 3 | HTTP Request (Context) | HTTP Request | Получение контекста (v0.1: httpbin заглушка) |
| 4 | Code (Build Prompt) | Code | Сборка промпта из вопроса, ответа, норматива, критериев |
| 5 | HTTP Request (LLM) | HTTP Request | Запрос к Claude API |
| 6 | Code (Format) | Code | Парсинг ответа LLM, формирование Markdown-комментария |
| 7 | Respond to Webhook | Response | Возврат `{comment, checked_at, raw_llm}` |

### Экспорт workflow

JSON-экспорт workflow хранится в общем описании проверяльщика ДЗ и может быть импортирован в n8n.

---

## Часть 3: Репозиторий руководств (внешний)

**v0.1:** Используется заглушка `https://httpbin.org/post`.

**v0.2:** MCP-сервер по аналогии с [fsm-mcp](https://github.com/aisystant/fsm-mcp).

| № | Компонент | Описание | Статус |
|---|-----------|----------|--------|
| G.1 | MCP endpoint `/check-context` | Возвращает normative_text и rubric | ⏳ TODO |
| G.2 | Структура guides/ | Markdown-файлы руководств по курсам | ⏳ TODO |
| G.3 | Структура rubrics/ | YAML-файлы с критериями и весами | ⏳ TODO |

---

## Сводка

| Категория | Статус v0.1 |
|-----------|-------------|
| Описания (content/) | ✅ 5 документов готовы |
| n8n workflow | ✅ Реализован (7 нод) |
| Репозиторий руководств | ⏳ Используется заглушка |
| Интеграция с LMS | ⏳ Ожидает реализации на фронте |

---

## Что осталось для v0.1

| Задача | Описание |
|--------|----------|
| Заменить контекст-заглушку | httpbin → MCP endpoint репозитория руководств |
| Исправить LLM-ноду | Content-Type без `=`, Expression для тела |
| Использовать prod URL | `/webhook/check` вместо `/webhook-test/check` |
| Интеграция LMS | Кнопка «Проверить с ИИ» + обработка ответов |

---

**Статус:** ✅ n8n workflow готов, ожидает интеграции с репозиторием руководств и LMS
**Дата:** 2025-12-31
