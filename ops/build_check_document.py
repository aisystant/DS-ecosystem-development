#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (0.5)
–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞ 0.91

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python ops/build_check_document.py

–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤: content/0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.5. –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç.md
"""

import os
import re
from pathlib import Path
from datetime import datetime
from typing import Dict, List

# –ë–∞–∑–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
BASE_DIR = Path(__file__).parent.parent
CONTENT_DIR = BASE_DIR / "content"

# –ú–∞–ø–ø–∏–Ω–≥ —Ä–∞–∑–¥–µ–ª–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
DOCUMENT_MAPPING = {
    "1": {  # –ó–∞—á–µ–º, –¥–ª—è –∫–æ–≥–æ, —á—Ç–æ –º—ã –¥–µ–ª–∞–µ–º
        "title": "1. –ó–∞—á–µ–º, –¥–ª—è –∫–æ–≥–æ, —á—Ç–æ –º—ã –¥–µ–ª–∞–µ–º –∏ —á—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –≤ –º–∏—Ä–µ",
        "sources": [
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.4. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¶–ê.md",
            "2. –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ/–ú–∞–Ω–∏—Ñ–µ—Å—Ç.md"
        ],
        "extract_sections": ["# 0. –ö—Ä–∞—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ", "## A. –£–∫—Ä—É–ø–Ω—ë–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞"]
    },
    "2": {  # –ü—Ä–æ–±–ª–µ–º—ã, –≥–∏–ø–æ—Ç–µ–∑—ã, —Ü–µ–ª–∏
        "title": "2. –ö–∞–∫–∏–µ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –≥–∏–ø–æ—Ç–µ–∑—ã –∏ —Ü–µ–ª–∏ –º—ã –≤–∏–¥–∏–º",
        "sources": [
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.1. –ü—Ä–æ–±–ª–µ–º—ã.md",
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.2. –ì–∏–ø–æ—Ç–µ–∑—ã.md",
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.5. –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–µ–π –∏ –∑–∞–¥–∞—á.md"
        ],
        "summarize": True
    },
    "3": {  # –§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
        "title": "3. –ö–∞–∫ –º—ã –≤–∏–¥–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã",
        "sources": [
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.4. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¶–ê.md"
        ],
        "extract_sections": ["## B. –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã", "## F. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"]
    },
    "4": {  # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ò–ò-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        "title": "4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ò–ò-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã",
        "sources": [
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.4. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¶–ê.md",
            "4. –°–∏—Å—Ç–µ–º—ã/4.2. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ò–ò-–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.md"
        ],
        "extract_sections": ["## C. –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∏—Å—Ç–µ–º"]
    },
    "5": {  # –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∏—Å—Ç–µ–º
        "title": "5. –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∏—Å—Ç–µ–º",
        "sources": [
            "4. –°–∏—Å—Ç–µ–º—ã/4.1. –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∏—Å—Ç–µ–º.md",
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.4. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¶–ê.md"
        ],
        "extract_sections": ["## C. –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∏—Å—Ç–µ–º"]
    },
    "6": {  # –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        "title": "6. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º",
        "sources": [
            "1. –ò–¥–µ–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã/1.4. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¶–ê.md"
        ],
        "extract_sections": ["## D. –î–∞–Ω–Ω—ã–µ –∏ –ú–ò–ú"]
    },
    "7": {  # –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        "title": "7. –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏",
        "sources": [
            "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.8. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–±–æ—Ç—ã.md"
        ],
        "extract_sections": ["### –ö–∞–∫ –∏–¥—ë—Ç —Ä–∞–±–æ—Ç–∞"]
    },
    "8": {  # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ç–µ–≥–∏
        "title": "8. –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–µ–∫—É—â–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∫–∞–∫–∏–µ —Ç–µ–≥–∏ —É –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
        "sources": [
            "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.7. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Ç–µ–≥–∏.md"
        ],
        "extract_sections": ["## –ë–∞–∑–æ–≤–∞—è —Å—Ö–µ–º–∞", "## –ö–∞—Ä—Ç–∞"]
    }
}


def read_document(file_path: Path) -> str:
    """–ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except FileNotFoundError:
        return f"‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω: {file_path}"


def extract_sections(content: str, sections: List[str]) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    result = []
    lines = content.split('\n')
    capturing = False
    current_section = None

    for line in lines:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—á–∞–ª–æ –Ω—É–∂–Ω–æ–π —Å–µ–∫—Ü–∏–∏
        for section in sections:
            if line.strip().startswith(section):
                capturing = True
                current_section = section
                result.append(line)
                break
        else:
            if capturing:
                # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞—Ö–≤–∞—Ç –ø—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–æ–≥–æ –∂–µ —É—Ä–æ–≤–Ω—è
                if line.startswith('#') and not line.startswith('####'):
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–∏ –Ω–æ–≤—ã–π –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª
                    is_new_section = any(line.strip().startswith(s) for s in sections)
                    if not is_new_section:
                        capturing = False
                        continue

                if capturing:
                    result.append(line)

    return '\n'.join(result)


def summarize_section(content: str, max_items: int = 10) -> str:
    """–°–æ–∑–¥–∞–µ—Ç –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É —Ä–∞–∑–¥–µ–ª–∞"""
    lines = content.split('\n')
    important_lines = []

    for line in lines:
        # –°–æ–±–∏—Ä–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Å–ø–∏—Å–∫–∏
        if line.startswith('#') or line.strip().startswith('**') or line.strip().startswith('-'):
            important_lines.append(line)
            if len(important_lines) >= max_items:
                break

    return '\n'.join(important_lines[:max_items])


def build_section(section_num: str, config: Dict) -> str:
    """–°–æ–±–∏—Ä–∞–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª –ø—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
    result = [f"\n## {config['title']}\n"]

    for source in config['sources']:
        source_path = CONTENT_DIR / source
        content = read_document(source_path)

        if "‚ö†Ô∏è" in content:
            result.append(content)
            continue

        # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω—É–∂–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –∏–ª–∏ –¥–µ–ª–∞–µ–º —Å–≤–æ–¥–∫—É
        if 'extract_sections' in config:
            extracted = extract_sections(content, config['extract_sections'])
            if extracted:
                result.append(extracted)
        elif config.get('summarize'):
            summary = summarize_section(content)
            result.append(summary)
        else:
            # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ N —Å—Ç—Ä–æ–∫
            result.append('\n'.join(content.split('\n')[:50]))

    return '\n'.join(result)


def analyze_contradictions() -> str:
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö"""
    return """
## 9. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è—Ö –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è—Ö

### –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞.
–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

### –û–±–ª–∞—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
1. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ü–µ–ª–µ–π –∏ —Å–∏—Å—Ç–µ–º**: –≤—Å–µ –ª–∏ —Å–∏—Å—Ç–µ–º—ã –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 5 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Ü–µ–ª–∏ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 2?
2. **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ (—Ä–∞–∑–¥–µ–ª 7) –æ–ø–∏—Å–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (—Ä–∞–∑–¥–µ–ª 4)?
3. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –¥–æ—Å—Ç—É–ø**: –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 8 –∫–æ –≤—Å–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º?
4. **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å**: —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –ª–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã —ç–∫–æ–Ω–æ–º–∏–∫–∏ –≤–∫–ª–∞–¥–∞ –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏ 2, 3 –∏ 5?

### –°—Ç–∞—Ç—É—Å
üîÑ **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏**

_–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞._
"""


def build_check_document() -> str:
    """–°–æ–±–∏—Ä–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç"""

    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    header = f"""# –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –¥–∞—ë—Ç —Å–≤–æ–¥–∫—É —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏:
–ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ —Ä–µ—à–µ–Ω–∏—è –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–∞—Ö, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞—Ö –∏ –º–µ—Ç—Ä–∏–∫–∞—Ö;
—á–µ–ª–æ–≤–µ–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏–ª–∏ –ø–æ–º–µ—á–∞–µ—Ç –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞:** `0.91. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.md`

---
"""

    # –°–æ–±–∏—Ä–∞–µ–º —Ä–∞–∑–¥–µ–ª—ã
    sections = []
    for section_num in sorted(DOCUMENT_MAPPING.keys()):
        config = DOCUMENT_MAPPING[section_num]
        print(f"–°–æ–±–∏—Ä–∞—é —Ä–∞–∑–¥–µ–ª {section_num}: {config['title']}...")
        section_content = build_section(section_num, config)
        sections.append(section_content)

    # –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π
    sections.append(analyze_contradictions())

    # –°–æ–±–∏—Ä–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
    full_document = header + '\n'.join(sections)

    return full_document


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä–∫—É –ü—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞...")
    print(f"üìÅ –ë–∞–∑–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: {BASE_DIR}")
    print(f"üìÑ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞: {CONTENT_DIR}\n")

    # –°–æ–±–∏—Ä–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
    document = build_check_document()

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    output_path = CONTENT_DIR / "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" / "0.5. –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç.md"
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(document)

    print(f"\n‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–±—Ä–∞–Ω!")
    print(f"üìç –°–æ—Ö—Ä–∞–Ω–µ–Ω –≤: {output_path}")
    print(f"üìä –†–∞–∑–º–µ—Ä: {len(document)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"\nüí° –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –∏ –æ—Ç–º–µ—Ç—å—Ç–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ 9")


if __name__ == "__main__":
    main()
